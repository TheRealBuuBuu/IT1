<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>SQL</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="generator" content="Jekyll v3.0.1">
  <link type="application/atom+xml" rel="alternate" href="/feed.xml" title="IT1 • Læremidler for informasjonsteknologifaget" />
  <link rel="alternate" type="application/atom+xml" title="Recent commits to Jekyll’s master branch" href="https://github.com/fagstoff/IT1/commits/master.atom">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic,900">
  <link rel="stylesheet" href="/css/screen.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <!--[if lt IE 9]>
  <script src="/js/html5shiv.min.js"></script>
  <script src="/js/respond.min.js"></script>
  <![endif]-->
</head>


<body class="wrap">
  <header role="banner">
  <nav class="mobile-nav show-on-mobiles">
    <ul>
  <li class="">
    <a href="/">Hjem</a>
  </li>
  <li class="current">
    <a href="/docs/home/">Lære<span class="show-on-mobiles">s</span><span class="hide-on-mobiles">midler</span></a>
  </li>
  <li class="">
    <a href="/news/">Nyheter</a>
  </li>
  <li>
    <a href="/curriculum/">Læreplan</a>
  </li>
  <li>
    <a href="https://github.com/fagstoff/IT1"><span class="hide-on-mobiles">Vis på </span>GitHub</a>
  </li>
</ul>

  </nav>
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
      <h1>
        <a href="/">
          <span class="sr-only">IT</span>
          <img src="/img/IT-logo-256.png" width="256" height="70" alt="IT-logo">
        </a>
      </h1>
    </div>
    <nav class="main-nav unit two-thirds hide-on-mobiles">
      <ul>
  <li class="">
    <a href="/">Hjem</a>
  </li>
  <li class="current">
    <a href="/docs/home/">Lære<span class="show-on-mobiles">s</span><span class="hide-on-mobiles">midler</span></a>
  </li>
  <li class="">
    <a href="/news/">Nyheter</a>
  </li>
  <li>
    <a href="/curriculum/">Læreplan</a>
  </li>
  <li>
    <a href="https://github.com/fagstoff/IT1"><span class="hide-on-mobiles">Vis på </span>GitHub</a>
  </li>
</ul>

    </nav>
  </div>
</header>


  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

  <section class="docs">
    <div class="grid">

      <div class="docs-nav-mobile unit whole show-on-mobiles">
  <select onchange="if (this.value) window.location.href=this.value">
    <option value="">Navigate the docs…</option>
    
    <optgroup label="Databaser">
      


  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  

  
    
      <option value="/docs/Databaser/01. Hva er en database/">Hva er en database?</option>
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  

  
    
  
    
      <option value="/docs/Databaser/02. SQL/">SQL</option>
    
  
    
  
    
  
    
  
    
  
    
  

  

  
    
  
    
  
    
      <option value="/docs/Databaser/03. Design av databaser/">Design av databaser</option>
    
  
    
  
    
  
    
  
    
  

  

  
    
  
    
  
    
  
    
      <option value="/docs/Databaser/04. PHP/">PHP</option>
    
  
    
  
    
  
    
  


    </optgroup>
    
    <optgroup label="Oppgaver">
      


  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


    </optgroup>
    
    <optgroup label="Nyttige verktøy">
      


  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


    </optgroup>
    
    <optgroup label="Meta">
      


  

  
    
  
    
  
    
  
    
  
    
      <option value="/docs/contributing/">Bidra</option>
    
  
    
  
    
  

  

  
    
  
    
  
    
  
    
  
    
  
    
      <option value="/docs/history/">Historikk</option>
    
  
    
  


    </optgroup>
    
  </select>
</div>


      <div class="unit four-fifths">
        <article>
          <div class="improve right hide-on-mobiles">
            <a href="https://github.com/fagstoff/IT1/blob/master//_docs/Databaser/02. SQL.md"><i class="fa fa-pencil"></i> &nbsp;Gjør denne siden bedre</a>
          </div>
          <h1>SQL</h1>
          <p><strong>SQL (Structured Query Language) er et programmeringsspråk som er laget spesielt for å håndtere data som er lagret i et relasjonsdatabasesystem. Språket ble utviklet av IBM tidlig på 1970-tallet, og det ble en internasjonal standard siden 1986. Men selv om SQL er standardisert finnes det i mange ulike dialekter og varianter. Eksempler på relasjonsdatabasesystemer som alle har sine egne variasjoner av SQL er Oracle RDBMS, MySQL, PostgreSQL, Microsoft SQL Server og SQLite.</strong></p>

<ul id="markdown-toc">
  <li><a href="#sql-sprket" id="markdown-toc-sql-sprket">SQL-språket</a></li>
  <li><a href="#en-oversikt-over-sql-syntaksen" id="markdown-toc-en-oversikt-over-sql-syntaksen">En oversikt over SQL-syntaksen</a></li>
  <li><a href="#opprette-og-slette-tabeller" id="markdown-toc-opprette-og-slette-tabeller">Opprette og slette tabeller</a></li>
  <li><a href="#legge-inn-og-slette-rader-i-en-tabell" id="markdown-toc-legge-inn-og-slette-rader-i-en-tabell">Legge inn og slette rader i en tabell</a></li>
  <li><a href="#verdien-null" id="markdown-toc-verdien-null">Verdien NULL</a></li>
  <li><a href="#tabellnkler" id="markdown-toc-tabellnkler">Tabellnøkler</a></li>
  <li><a href="#filtrering-av-data-med-where-like-og-in" id="markdown-toc-filtrering-av-data-med-where-like-og-in">Filtrering av data med WHERE, LIKE og IN</a></li>
  <li><a href="#fjerne-duplikater-med-select-distinct" id="markdown-toc-fjerne-duplikater-med-select-distinct">Fjerne duplikater med SELECT DISTINCT</a></li>
  <li><a href="#relasjoner" id="markdown-toc-relasjoner">Relasjoner</a></li>
  <li><a href="#join" id="markdown-toc-join">JOIN</a></li>
  <li><a href="#transaction" id="markdown-toc-transaction">TRANSACTION</a></li>
</ul>

<p><img src="https://upload.wikimedia.org/wikipedia/en/5/58/Edgar_F_Codd.jpg" alt="Edgar F. Codd, mannen som oppfant relasjonsmodellen - den teoretiske basisen for relasjonsdatabaser. Foto: &copy; IBM" /><br />
<em>Edgar F. Codd, mannen som oppfant relasjonsmodellen - den teoretiske basisen for relasjonsdatabaser. Foto: © IBM</em></p>

<h2 id="sql-sprket">SQL-språket</h2>

<p>SQL-språket kan deles inn i tre hovedkategorier:<br />
 * DDL (Data Definition Language) som brukes for å definere databasestrukturer, for eksempel opprette databaser eller tabeller.<br />
 * DML (Data Manipulation Language) som brukes for å opprette, velge ut, oppdatere og slette data i en database.<br />
 * DCL (Data Control Language) som brukes for kontrolloperasjoner, for eksempel gi en bruker tilgang til en tabell i en database.</p>

<h2 id="en-oversikt-over-sql-syntaksen">En oversikt over SQL-syntaksen</h2>

<p><strong>SQL er et standardisert språk for å beskrive relasjonsdatabaser og spørringer. Standarden ble formalisert av American National Standards Institute (ANSI) i 1986, og revidert i 1989 og 1992. SQL 92 ble formelt vedtatt av International Organization for Standards (ISO) som ISO 9075.</strong></p>

<p>Siden 1992 har ISO oppdatert standarden flere ganger, og den nåværende versjonen er SQL 2011. Historien om databaser er lang og kompleks. Mange av de mest kjente SQL-systemene ble til før det fantes noen standard, og nyere databasesystemer kan ha arvet kode fra eldre systemer. For at gamle databaser fortsatt skal fungere, må databasesystemene dra med seg mange eldre varianter av SQL. Dermed har det oppstått mange dialekter og varianter av språket.</p>

<p>Hva betyr dette for deg? Du må være klar over at uansett hva slags variant av SQL du skriver vil det vanligvis være noen noen leverandørspesifikke ting du må ta hensyn til, og du må være forberedt på å gjøre noen endringer for at det skal fungere på et annet system. I dette kurset skal du lære om de kjernefunksjonene i SQL som støttes av alle de store databasesystemer. Når det er sagt, er det viktig å forstå at mange detaljer varierer fra system til system.</p>

<p>Et SQL-setning begynner med et nøkkelord og avsluttes med et semikolon. Her er en setning som henter ut alt innholdet i en tabell:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tabell</span><span class="p">;</span>
</code></pre>
</div>

<p>Et nøkkelord er et reservert ord som har en spesiell betydning i et programmeringsspråk. At de er reserverte betyr for eksempel at du ikke kan bruke disse nøkkelordene som navn på tabeller eller eller kolonner. I SQL-setningen ovenfor er <code class="highlighter-rouge">SELECT</code> og <code class="highlighter-rouge">FROM</code> nøkkelord.</p>

<p>SQL skiller ikke mellom store og små bokstaver i nøkkelordene, så dette er akkurat det samme som forrige eksempel:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">tabell</span><span class="p">;</span>
</code></pre>
</div>

<p>I dette kurset vil allikevel alle SQL-nøkkelord bli skrevet med store bokstaver, selv om dette altså ikke er nødvendig. Med store bokstaver blir det enklere for deg å se hva som er SQL-nøkkelord og hva som er andre ting i koden.</p>

<p>Kommentarer i SQL kan skrives inn etter to bindestreker og et mellomrom:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tabell</span><span class="p">;</span> <span class="c1">-- Dette er en kommentar.
</span></code></pre>
</div>

<p>Et SQL-uttrykk kan ha ett eller flere betingelser som må oppfylles for hver rad som velges. La oss si at vi skal finne ingredienser og mengder som inngår når vi skal lage menyen <code class="highlighter-rouge">Superburger</code>. Vi finner det slik:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Oppskrift</span> <span class="k">WHERE</span> <span class="n">Menynavn</span> <span class="o">=</span> <span class="s1">'Superburger'</span><span class="p">;</span>
</code></pre>
</div>

<p>Her har vi to betingelser. Først sier vi at vi skal hente rader fra tabellen Oppskrift (en FROM-betingelse), men i tillegg krever vi at det kun skal hentes ut rader som gjelder for menyen <code class="highlighter-rouge">Superburger</code> (en WHERE-betingelse). Legg også merke til at tekststrenger i SQL skrives mellom apostrofer (‘).</p>

<p>Vi kan også bruke logiske uttrykk i SQL, for eksempel når vi vil finne de varene vi har færre enn 100 igjen av i lagerbeholdningen vår:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Lagerbeholdning</span> <span class="k">WHERE</span> <span class="n">Beholdning</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span>
</code></pre>
</div>

<p>Vi kan også ordne resultatene etter ulike kriterier. La oss si at vi vil se alle varer hvor det er færre enn 100 igjen, og vi vil ha lista alfabetisert på varenavnet:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Lagerbeholdning</span> <span class="k">WHERE</span> <span class="n">Antall</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">Varenavn</span><span class="p">;</span>
</code></pre>
</div>

<p>SQL-strukturen er enkel, men uttrykkene vi kan sette opp kan være veldig komplekse og gjøre avanserte operasjoner i databasen. I dette kurset skal vi holde uttrykkene på et forholdsvis enkelt nivå.</p>

<h2 id="opprette-og-slette-tabeller">Opprette og slette tabeller</h2>

<p><strong>Her skal vi se på hvordan vi oppretter og sletter tabeller i en SQL-database.</strong></p>

<p>Nå skal vi opprette en tabell hvor vi skal holde rede på lagerbeholdningen av råvarer i en hurtigmat-restaurant. Tabellen skal ha to kolonner, en for varenavnet og en for antallet vi har igjen av den aktuelle råvaren. Vi setter opp tabellen med denne SQL-setningen i SQLite:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Lagerbeholdning</span> <span class="p">(</span>
  <span class="n">Varenavn</span> <span class="n">CHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
  <span class="n">Beholdning</span> <span class="n">INTEGER</span>
<span class="p">);</span>
</code></pre>
</div>

<p>I MySQL gjøres det slik:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Lagerbeholdning</span> <span class="p">(</span>
  <span class="n">Varenavn</span> <span class="n">CHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
  <span class="n">Beholdning</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">Varenavn</span><span class="p">)</span>
<span class="p">);</span>
</code></pre>
</div>

<p>Her sier vi at vi skal opprette tabellen <code class="highlighter-rouge">Lagerbeholdning</code>, og det som står mellom parantesene () er kolonnenavnene og datatypen til hver enkelt kolonne. Vi bruker et komma for å skille mellom kolonnene, men det skal ikke være noe komma etter den siste kolonnedefinisjonen.</p>

<p>Det er en del viktige ting å tenke gjennom når du oppretter en tabell, og en av disse tingene er hvilken datatype hver enkelt kolonne skal ha. Her er det en del variasjon mellom ulike databasesystemer, så det er viktig at du leser gjennom dokumentasjonen for databasesystemet du bruker. Finn den datatypen som passer best, og vær sikker på at du forstår hva den innebærer.</p>

<p>Vi ønsker at kolonna <code class="highlighter-rouge">Varenavn</code> i vår tabell skal være en samling med tegn (CHAR eller CHARACTER), men begrenset oppad til maks 255 tegn.</p>

<p>I tabeller ønsker vi som oftest også å ha en kolonne med innhold som unikt identifiserer hver enkelt rad. Dette kalles for en primærnøkkel, og vi skal se nærmere på både primærnøkler og andre nøkler senere. I vår tabell velger vi at kolonna <code class="highlighter-rouge">Varenavn</code> er en primærnøkkel.</p>

<p>En av konsekvensene av at vi velger <code class="highlighter-rouge">Varenavn</code> som primærnøkkel er at vi ikke kan ha to varer med identiske navn. Hver enkelt vare i tabellen må ha et navn som unikt identifiserer varen. Senere skal vi også se på hva vi kan gjøre for å slippe å sjekke at alle varenavnene er unike.</p>

<p>Om du ikke trenger tabellen lenger, kan du slette den. Vær helt sikker på hva du gjør, for her har du ingen angremuligheter. Slik sletter du hele tabellen:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">Lagerbeholdning</span><span class="p">;</span>
</code></pre>
</div>

<p><strong>TODO</strong> Forklare ALTER</p>

<h2 id="legge-inn-og-slette-rader-i-en-tabell">Legge inn og slette rader i en tabell</h2>

<p><strong>Nå skal vi se på hvordan vi kan legge inn nye rader i en tabell, og hvordan vi kan slette rader.</strong></p>

<p>La oss fylle tabellen <code class="highlighter-rouge">Lagerbeholdning</code> med litt innhold:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Lagerbeholdning</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'Salatblader Crispi'</span><span class="p">,</span> <span class="mi">8376</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Lagerbeholdning</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'Grove burgerbrød Bakerverkstedet'</span><span class="p">,</span> <span class="mi">344</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Lagerbeholdning</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'Ketchup-poser Edda'</span><span class="p">,</span> <span class="mi">540</span><span class="p">);</span>
</code></pre>
</div>

<p>La oss si at vi tar ut en ketchup-pose fra lageret. Da må vi oppdatere lagerbeholdningen, antall ketchup-poser må reduseres med en. Det kan vi gjøre slik:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">Lagerbeholdning</span> <span class="k">SET</span> <span class="n">Beholdning</span> <span class="o">=</span> <span class="n">Beholdning</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">WHERE</span> <span class="n">Varenavn</span> <span class="o">=</span> <span class="s1">'Ketchup-poser Edda'</span><span class="p">;</span>
</code></pre>
</div>

<p>Vi kan også slette rader i tabellen:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">Lagerbeholdning</span> <span class="k">WHERE</span> <span class="n">Varenavn</span> <span class="o">=</span> <span class="s1">'Salatblader Crispi'</span><span class="p">;</span>
</code></pre>
</div>
<p>Her sletter vi kun den raden i tabellen som har varenavnet <code class="highlighter-rouge">Salatblader Crispi</code>, alle rader som har et annet varenavn er ikke berørt.</p>

<p><strong>TODO</strong> Velge fra en tabell og sette inn i en annen:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Superburgersalg</span> <span class="p">(</span><span class="n">Antall</span><span class="p">,</span> <span class="n">Dato</span><span class="p">)</span> <span class="k">SELECT</span> <span class="n">Salg</span> <span class="p">(</span><span class="n">Antall</span><span class="p">,</span> <span class="n">Dato</span><span class="p">)</span> <span class="k">WHERE</span> <span class="n">Menynavn</span> <span class="o">=</span> <span class="s1">'Superburger'</span><span class="p">;</span>
</code></pre>
</div>

<p><strong>TODO</strong> Forklare NULL</p>

<h2 id="verdien-null">Verdien NULL</h2>

<p><strong>TODO</strong></p>

<p>NULL er ikke 0.</p>

<h2 id="tabellnkler">Tabellnøkler</h2>

<p><strong>I Norge er det 730 menn som heter Jan Johansen. Dersom vi lager et databasesystem for å holde oversikt over personer, hvordan skal vi skille alle disse Jan Johansen-ene fra hverandre?</strong></p>

<p>Vi trenger et eller annet som er unikt for hver enkelt person, og en vanlig måte å gjøre dette på er å dele ut unike personnummer til hvert enkelt individ. Det er én og bare én person som kan ha et gitt personnummer. Dersom vi søker etter individet med personnummeret 123456 78901 vet vi at det bare kan være én enkelt person.</p>

<p>I tabellene i en SQL-database ønsker vi ofte at verdiene i minst en kolonne i tabellen er unik for hver enkelt rad. En tabell med personinformasjon kan for eksempel se slik ut:</p>

<table>
  <thead>
    <tr>
      <th>Personnummer</th>
      <th>Fornavn</th>
      <th>Etternavn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>123456 78901</td>
      <td>Jan</td>
      <td>Johansen</td>
    </tr>
    <tr>
      <td>345678 90123</td>
      <td>Jan</td>
      <td>Johansen</td>
    </tr>
    <tr>
      <td>567890 12345</td>
      <td>Jan</td>
      <td>Johansen</td>
    </tr>
    <tr>
      <td>789012 34567</td>
      <td>Jan</td>
      <td>Johansen</td>
    </tr>
    <tr>
      <td>901234 56789</td>
      <td>Jan</td>
      <td>Johansen</td>
    </tr>
  </tbody>
</table>

<p>Vi kaller kolonner som har unike verdier for en nøkkel. Noen ganger kan en tabell ha mer enn en kolonne med unike verdier. Vi sier da at vi har flere <strong>kandidatnøkler</strong>, de er kandidater til å bli en <strong>primærnøkkel</strong> i tabellen.</p>

<p>Ofte er det sånn at vi ikke har noen kolonne som naturlig kan brukes som primærnøkkel, fordi vi ikke er sikre på at verdiene i kolonna alltid vil være unike for hver enkelt rad i tabellen. Da er det vanlig å lage en kolonne som inneholder heltallverdier, hvor vi sørger for at vi aldri bruker samme heltall flere ganger. Ofte kalles slike kolonner for <code class="highlighter-rouge">ID</code> eller noe liknende.</p>

<p>Vi henter fram lagerbeholdningstabellen fra hurtigmatrestauranten vår igjen:</p>

<table>
  <thead>
    <tr>
      <th>Varenavn</th>
      <th style="text-align: right">Beholdning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Hamburger 150 g</td>
      <td style="text-align: right">90</td>
    </tr>
    <tr>
      <td>Hamburger 200 g</td>
      <td style="text-align: right">447</td>
    </tr>
    <tr>
      <td>Tomatskiver</td>
      <td style="text-align: right">1232</td>
    </tr>
    <tr>
      <td>Sylteagurkskiver</td>
      <td style="text-align: right">987</td>
    </tr>
    <tr>
      <td>Cheddarostskiver</td>
      <td style="text-align: right">376</td>
    </tr>
    <tr>
      <td>Jarlsbergostskiver</td>
      <td style="text-align: right">83</td>
    </tr>
    <tr>
      <td>Burgerbrød</td>
      <td style="text-align: right">1995</td>
    </tr>
  </tbody>
</table>

<p>Når vi laget denne tabellen gikk vi ut ifra at varenavnet alltid ville være unikt, men er det lurt å anta dette? Kanskje bytter vi leverandør av 150 grams hamburgere en gang i framtida, og ønsker å skille gamle og nye varer fra hverandre? Det kan i alle fall være lurt å ta høyde for endringer i framtida, så derfor legger vi inn en ny ID-kolonne i tabellen vår som er unik for hver enkelt vare i tabellen:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">VareID</th>
      <th>Varenavn</th>
      <th style="text-align: right">Beholdning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">1</td>
      <td>Hamburger 150 g</td>
      <td style="text-align: right">90</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td>Hamburger 200 g</td>
      <td style="text-align: right">447</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td>Tomatskiver</td>
      <td style="text-align: right">1232</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td>Sylteagurkskiver</td>
      <td style="text-align: right">987</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td>Cheddarostskiver</td>
      <td style="text-align: right">376</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td>Jarlsbergostskiver</td>
      <td style="text-align: right">83</td>
    </tr>
    <tr>
      <td style="text-align: right">7</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1995</td>
    </tr>
  </tbody>
</table>

<p>Nå ser det kanskje ut som om vi bare har laget radnummer i tabellen vår, slik vi for eksempel har i regneark. Sånn er det ikke i SQL. I en SQL-tabell har ikke radene noen spesiell rekkefølge, så vi kan ikke be om å få en spesiell rad i tabellen. Ønsker vi å referere til en spesiell rad i tabellen må vi selv sørge for å lage en primærnøkkel i tabellen.</p>

<p>Ulike SQL-systemer har forskjellige måter å opprette primærnøkler på, så du må alltid sjekke i dokumentasjonen for systemet du jobber med for å finne ut hvordan det skal gjøres. Her kan du se hvordan det gjøres i MySQL og i SQLite:</p>

<p><strong>MySQL</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Lagerbeholdning</span> <span class="p">(</span>
  <span class="n">VareID</span> <span class="n">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
  <span class="n">Varenavn</span> <span class="n">CHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
  <span class="n">Beholdning</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">(</span><span class="n">VareID</span><span class="p">)</span>
<span class="p">);</span>
</code></pre>
</div>

<p><strong>SQLite</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Lagerbeholdning</span> <span class="p">(</span>
  <span class="n">VareID</span> <span class="n">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
  <span class="n">Varenavn</span> <span class="n">CHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
  <span class="n">Beholdning</span> <span class="n">INTEGER</span>
<span class="p">);</span>
</code></pre>
</div>

<p>Når vi har laget denne tabellen trenger vi ikke å lage noen verdi for <code class="highlighter-rouge">VareID</code> selv, det gjøres helt automatisk. Vi kan sette inn nye rader i tabellen slik:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Lagerbeholdning</span> <span class="p">(</span><span class="n">Varenavn</span><span class="p">,</span> <span class="n">Beholdning</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'Jalapeño'</span><span class="p">,</span> <span class="mi">1500</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Lagerbeholdning</span> <span class="p">(</span><span class="n">Varenavn</span><span class="p">,</span> <span class="n">Beholdning</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'Løkringer'</span><span class="p">,</span> <span class="mi">2930</span><span class="p">);</span>
</code></pre>
</div>

<h2 id="filtrering-av-data-med-where-like-og-in">Filtrering av data med WHERE, LIKE og IN</h2>

<p><strong>Når du henter data fra en SQL-tabell vil du som oftest ikke ha hele tabellen, du vil bare hente ut det som stemmer med noen gitte kriterier. For å angi kriteriene bruker du nøkkelordet <code class="highlighter-rouge">WHERE</code> etterfulgt av kriteriene dine.</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Lagerbeholdning</span> <span class="k">WHERE</span> <span class="n">Beholdning</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Lagerbeholdning</span> <span class="k">WHERE</span> <span class="n">Varenavn</span> <span class="k">LIKE</span> <span class="s1">'%skive%'</span><span class="p">;</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Lagerbeholdning</span> <span class="k">WHERE</span> <span class="n">Varenavn</span> <span class="k">LIKE</span> <span class="s1">'%skive%'</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">Beholdning</span><span class="p">;</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Lagerbeholdning</span> <span class="k">WHERE</span> <span class="n">Beholdning</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="k">AND</span> <span class="n">Varenavn</span> <span class="k">LIKE</span> <span class="s1">'%skive%'</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">Beholdning</span> <span class="k">DESC</span><span class="p">;</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Lagerbeholdning</span> <span class="k">WHERE</span> <span class="n">Varenavn</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'Cheddarostskiver'</span><span class="p">,</span> <span class="s1">'Jarlsbergostskiver'</span><span class="p">);</span>
</code></pre>
</div>

<h2 id="fjerne-duplikater-med-select-distinct">Fjerne duplikater med SELECT DISTINCT</h2>

<p><strong>TODO</strong></p>

<p>Fjerne duplikater</p>

<h2 id="relasjoner">Relasjoner</h2>

<p><strong>Nå skal vi gå litt grundigere til verks når vi planlegger databasen til hurtigmatrestauranten.</strong></p>

<p>Tidligere har vi sett at vi kan sette opp en tabell for oppskrifter til hurtigmatrestauranten på denne måten:</p>

<table>
  <thead>
    <tr>
      <th>Menynavn</th>
      <th>Ingrediens</th>
      <th style="text-align: right">Antall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Superburger</td>
      <td>Hamburger 150</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Superburger</td>
      <td>Tomatskiver</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td>Superburger</td>
      <td>Sylteagurkskiver</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Superburger</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Cheeseburger</td>
      <td>Hamburger 200 g</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Cheeseburger</td>
      <td>Cheddarostskiver</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td>Cheeseburger</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Veggis</td>
      <td>Tomatskiver</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td>Veggis</td>
      <td>Jarlsbergostskiver</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Veggis</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
  </tbody>
</table>

<p>Dersom vi for eksempel vil ha oppskriften for Cheeseburger, kan vi spørre slik:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Oppskrift</span> <span class="k">WHERE</span> <span class="n">Menynavn</span> <span class="o">=</span> <span class="s1">'CheeseBurger'</span><span class="p">;</span>
</code></pre>
</div>

<p>Dette ville fungert, men det kan lett oppstå problemer. Hva om vi for eksempel ved en feil la inn en rader i tabellen som er identiske med rader som er der fra før?</p>

<table>
  <thead>
    <tr>
      <th>Menynavn</th>
      <th>Ingrediens</th>
      <th style="text-align: right">Antall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Superburger</td>
      <td>Hamburger 150</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Superburger</td>
      <td>Tomatskiver</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td>Superburger</td>
      <td>Sylteagurkskiver</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Superburger</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Cheeseburger</td>
      <td>Hamburger 200 g</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Cheeseburger</td>
      <td>Cheddarostskiver</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td>Cheeseburger</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Veggis</td>
      <td>Tomatskiver</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td>Veggis</td>
      <td>Jarlsbergostskiver</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Veggis</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Cheeseburger</td>
      <td>Hamburger 200 g</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>Cheeseburger</td>
      <td>Cheddarostskiver</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td>Cheeseburger</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
  </tbody>
</table>

<p>Kjører vi spørringen på nytt, får vi nå dobbelt opp av alle ingrediensene for Cheeseburger. Vi må slette de radene som ble lagt inn ved en feil, men hvordan gjør vi det? Vi har ikke noe som unikt identifiserer hver rad i tabellen vår, og det er dermed ikke mulig å bare slette de tre radene som står nederst.</p>

<p>Vi må innføre en kolonne med verdier som vi er sikre på at alltid er unike. Vi lager kolonna <code class="highlighter-rouge">OppskriftID</code> som består av positive heltall (INTEGER), og sørger for at databasesystemet alltid sørger for å sette inn et unikt tall i denne kolonna for hver enkelt rad. Nå ser tabellen vår slik ut:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">OppskriftID</th>
      <th>Menynavn</th>
      <th>Ingrediens</th>
      <th style="text-align: right">Antall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">1</td>
      <td>Superburger</td>
      <td>Hamburger 150</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td>Superburger</td>
      <td>Tomatskiver</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td>Superburger</td>
      <td>Sylteagurkskiver</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td>Superburger</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td>Cheeseburger</td>
      <td>Hamburger 200 g</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td>Cheeseburger</td>
      <td>Cheddarostskiver</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: right">7</td>
      <td>Cheeseburger</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">8</td>
      <td>Veggis</td>
      <td>Tomatskiver</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td style="text-align: right">9</td>
      <td>Veggis</td>
      <td>Jarlsbergostskiver</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">10</td>
      <td>Veggis</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1</td>
    </tr>
  </tbody>
</table>

<p>Den nye kolonna med ID-er gjør vi til en primærnøkkel for tabellen. Vi gjør tilsvarende for alle de andre tabellene i hurtigmatrestaurantdatabasen vår. Nå kan vi bruke ID-kolonnene vi har laget i alle tabellene som referanser når vi skal henvise fra en tabell til noe som ligger i en annen tabell.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">OppskriftID</th>
      <th style="text-align: right">MenyID</th>
      <th style="text-align: right">VareID</th>
      <th style="text-align: right">Antall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">4</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">7</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">5</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: right">7</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">7</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">8</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td style="text-align: right">9</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">6</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">10</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">7</td>
      <td style="text-align: right">1</td>
    </tr>
  </tbody>
</table>

<p>Tilsvarende ser nå menytabellen slik ut:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">MenyID</th>
      <th>Menynavn</th>
      <th style="text-align: right">Pris</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">1</td>
      <td>Superburger</td>
      <td style="text-align: right">89</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td>Cheeseburger</td>
      <td style="text-align: right">99</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td>Veggis</td>
      <td style="text-align: right">49</td>
    </tr>
  </tbody>
</table>

<p>Lagerbeholdningtabellen ser slik ut:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">VareID</th>
      <th>Varenavn</th>
      <th style="text-align: right">Beholdning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">1</td>
      <td>Hamburger 150 g</td>
      <td style="text-align: right">90</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td>Hamburger 200 g</td>
      <td style="text-align: right">447</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td>Tomatskiver</td>
      <td style="text-align: right">1232</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td>Sylteagurkskiver</td>
      <td style="text-align: right">987</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td>Cheddarostskiver</td>
      <td style="text-align: right">376</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td>Jarlsbergostskiver</td>
      <td style="text-align: right">83</td>
    </tr>
    <tr>
      <td style="text-align: right">7</td>
      <td>Burgerbrød</td>
      <td style="text-align: right">1995</td>
    </tr>
  </tbody>
</table>

<p>Slik setter vi opp tabellene våre i SQLite:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Lagerbeholdning</span> <span class="p">(</span>
  <span class="n">VareID</span> <span class="n">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
  <span class="n">Varenavn</span> <span class="n">CHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
  <span class="n">Beholdning</span> <span class="n">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Meny</span> <span class="p">(</span>
  <span class="n">MenyID</span> <span class="n">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
  <span class="n">Menynavn</span> <span class="n">CHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
  <span class="n">Pris</span> <span class="n">FLOAT</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Oppskrift</span> <span class="p">(</span>
  <span class="n">OppskriftID</span> <span class="n">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
  <span class="n">MenyID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">VareID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">Antall</span> <span class="n">INTEGER</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Salg</span> <span class="p">(</span>
  <span class="n">SalgID</span> <span class="n">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
  <span class="n">MenyID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">Antall</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="k">Sum</span> <span class="n">FLOAT</span><span class="p">,</span>
  <span class="n">Dato</span> <span class="k">TIMESTAMP</span>
<span class="p">);</span>
</code></pre>
</div>

<p>I MySQL setter vi opp tabellene slik:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Lagerbeholdning</span> <span class="p">(</span>
  <span class="n">VareID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">Varenavn</span> <span class="n">CHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
  <span class="n">Beholdning</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">VareID</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Meny</span> <span class="p">(</span>
  <span class="n">MenyID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">Menynavn</span> <span class="n">CHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
  <span class="n">Pris</span> <span class="n">FLOAT</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">MenyID</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Oppskrift</span> <span class="p">(</span>
  <span class="n">OppskriftID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">MenyID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">VareID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">Antall</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">OppskriftID</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Salg</span> <span class="p">(</span>
  <span class="n">SalgID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">MenyID</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">Antall</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="k">Sum</span> <span class="n">FLOAT</span><span class="p">,</span>
  <span class="n">Dato</span> <span class="k">TIMESTAMP</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">SalgID</span><span class="p">)</span>
<span class="p">);</span>
</code></pre>
</div>

<h2 id="join">JOIN</h2>

<p><strong>TODO</strong></p>

<p>TODO</p>

<h2 id="transaction">TRANSACTION</h2>

<p><strong>I databaser er det ofte nødvendig at vi er helt sikre på at flere verdier oppdateres samtidig. Da kan vi bruke funksjonen <code class="highlighter-rouge">TRANSACTION</code>.</strong></p>

<p>Når vi gjør et salg i hurtigmatrestauranten registrerer vi det i tabellen Salg. Samtidig er det viktig at vi oppdaterer Lagerbeholdningen. Om bare én av disse tabellene blir oppdatert, vil vi få et avvik mellom varebeholdningen og hva vi faktisk har solgt.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">BEGIN</span> <span class="n">TRANSACTION</span><span class="p">;</span>
  <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Salg</span> <span class="p">(</span><span class="n">MenyID</span><span class="p">,</span> <span class="n">Antall</span><span class="p">,</span> <span class="k">Sum</span><span class="p">,</span> <span class="n">Dato</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="n">DATETIME</span><span class="p">(</span><span class="s1">'now'</span><span class="p">));</span>
  <span class="k">UPDATE</span> <span class="n">Lagerbeholdning</span> <span class="k">SET</span> <span class="n">Beholdning</span> <span class="o">=</span> <span class="p">(</span><span class="n">Beholdning</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">WHERE</span> <span class="n">VareID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">END</span> <span class="n">TRANSACTION</span><span class="p">;</span>
</code></pre>
</div>


          





  
  

  
  

  
  
    <div class="section-nav">
      <div class="left align-right">
          
            
            
            <a href="/docs/Databaser/01. Hva er en database/" class="prev">Back</a>
          
      </div>
      <div class="right align-left">
          
            
            
            <a href="/docs/Databaser/03. Design av databaser/" class="next">Next</a>
          
      </div>
    </div>
    <div class="clear"></div>
    
        </article>
      </div>

      <div class="unit one-fifth hide-on-mobiles">
  <aside>
    
    <h4>Databaser</h4>
    

<ul>

  

  

  
  <li class=""><a href=""></a></li>


  

  

  
  <li class=""><a href="/docs/Databaser/01. Hva er en database/">Hva er en database?</a></li>


  

  

  
  <li class="current"><a href="/docs/Databaser/02. SQL/">SQL</a></li>


  

  

  
  <li class=""><a href="/docs/Databaser/03. Design av databaser/">Design av databaser</a></li>


  

  

  
  <li class=""><a href="/docs/Databaser/04. PHP/">PHP</a></li>


</ul>

    
    <h4>Oppgaver</h4>
    

<ul>

  

  

  
  <li class=""><a href=""></a></li>


  

  

  
  <li class=""><a href=""></a></li>


  

  

  
  <li class=""><a href=""></a></li>


</ul>

    
    <h4>Nyttige verktøy</h4>
    

<ul>

  

  

  
  <li class=""><a href=""></a></li>


  

  

  
  <li class=""><a href=""></a></li>


  

  

  
  <li class=""><a href=""></a></li>


</ul>

    
    <h4>Meta</h4>
    

<ul>

  

  

  
  <li class=""><a href="/docs/contributing/">Bidra</a></li>


  

  

  
  <li class=""><a href="/docs/history/">Historikk</a></li>


</ul>

    
  </aside>
</div>


      <div class="clear"></div>

    </div>
  </section>


  <footer role="contentinfo">
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
      <p>Nettsted-designet er opprinnelig laget av <a href="http://tom.preston-werner.com/">Tom Preston-Werner</a> og distribuert under en <a href="https://github.com/fagstoff/IT1/blob/master/LICENSE">MIT-lisens</a>.<br>Endringer og tilpasninger for bruk i IT-fagene er gjort av <a href="https://github.com/fuzzbin">fuzzbin</a> og <a href="https://github.com/bitjungle">bitjungle</a>.</p>
    </div>
    <div class="unit one-third center-on-mobiles">
      <p>&nbsp;</p>
    </div>
    <div class="unit one-third center-on-mobiles">
      <p>Dersom intet annet er angitt, er alt nettstedinnhold laget av <a href="https://github.com/fuzzbin">fuzzbin</a> og <a href="https://github.com/bitjungle">bitjungle</a>. Innholdet distribueres under lisensen <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.no">Creative Commons BY-SA</a>.
      </p>
    </div>
  </div>
</footer>

  <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("news")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>

  


</body>
</html>
